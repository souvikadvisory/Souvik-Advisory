<script>
document.addEventListener("DOMContentLoaded", () => {

  /* ===============================
     1. Custom Cursor
  =============================== */
  const cursor = document.createElement("div");
  cursor.classList.add("cursor");
  document.body.appendChild(cursor);

  document.addEventListener("mousemove", e => {
    cursor.style.left = e.clientX + "px";
    cursor.style.top = e.clientY + "px";
  });

  document.querySelectorAll("a, button").forEach(el => {
    el.addEventListener("mouseenter", () => cursor.classList.add("big"));
    el.addEventListener("mouseleave", () => cursor.classList.remove("big"));
  });

  /* ===============================
     2. Navbar Scroll Effect
  =============================== */
  const nav = document.querySelector("nav");
  window.addEventListener("scroll", () => {
    nav.classList.toggle("scrolled", window.scrollY > 40);
  });

  /* ===============================
     3. Mobile Menu
  =============================== */
  const hamburger = document.querySelector(".hamburger");
  const mob = document.querySelector(".mob");

  if (hamburger && mob) {
    hamburger.addEventListener("click", () => {
      mob.classList.toggle("open");
    });

    document.querySelectorAll(".mob a").forEach(link => {
      link.addEventListener("click", () => mob.classList.remove("open"));
    });
  }

  /* ===============================
     4. Scroll Reveal
  =============================== */
  const reveals = document.querySelectorAll(".reveal");
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) entry.target.classList.add("visible");
    });
  }, { threshold: 0.15 });

  reveals.forEach(el => observer.observe(el));

  /* ===============================
     5. Animated Counters
  =============================== */
  const counters = document.querySelectorAll("[data-count]");
  const counterObserver = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (!entry.isIntersecting) return;

      const el = entry.target;
      const target = +el.dataset.count;
      let current = 0;
      const increment = target / 80;

      const update = () => {
        current += increment;
        if (current < target) {
          el.innerText = Math.floor(current);
          requestAnimationFrame(update);
        } else {
          el.innerText = target + "+";
        }
      };

      update();
      counterObserver.unobserve(el);
    });
  }, { threshold: 0.6 });

  counters.forEach(counter => counterObserver.observe(counter));

  /* ===============================
     6. Active Nav Highlight
  =============================== */
  const sections = document.querySelectorAll("section");
  const navLinks = document.querySelectorAll(".nav-links a");

  window.addEventListener("scroll", () => {
    let current = "";
    sections.forEach(section => {
      const sectionTop = section.offsetTop - 120;
      if (window.scrollY >= sectionTop) {
        current = section.getAttribute("id");
      }
    });

    navLinks.forEach(link => {
      link.classList.remove("active");
      if (link.getAttribute("href").includes(current)) {
        link.classList.add("active");
      }
    });
  });

  /* ===============================
     7. WhatsApp Direct Connect
  =============================== */
  const phone = "919007638262";
  const waLinks = document.querySelectorAll("[data-wa]");

  waLinks.forEach(link => {
    link.addEventListener("click", e => {
      e.preventDefault();
      const message = link.dataset.wa || "Hello, I would like to connect regarding your services.";
      const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
      window.open(url, "_blank");
    });
  });

  /* ===============================
     8. Contact Form (Email Fallback)
  =============================== */
  const form = document.querySelector("#contact-form");

  if (form) {
    form.addEventListener("submit", e => {
      e.preventDefault();

      const name = form.querySelector("[name='name']").value.trim();
      const email = form.querySelector("[name='email']").value.trim();
      const message = form.querySelector("[name='message']").value.trim();

      if (!name || !email || !message) {
        alert("Please fill all required fields.");
        return;
      }

      const subject = `Website Inquiry from ${name}`;
      const body = `Name: ${name}%0AEmail: ${email}%0AMessage:%0A${message}`;

      window.location.href = `mailto:maiti.uk@yahoo.com?subject=${encodeURIComponent(subject)}&body=${body}`;
    });
  }

});
</script>
